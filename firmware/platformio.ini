; ==========================================================
; ESP-GlassHole — PlatformIO Configuration
; ==========================================================
;
; ESP32 BLE scanner that detects AR/smart glasses nearby
; and flashes the LED as a visual alert.
;
; Build:   pio run -e esp32dev
; Flash:   pio run -e esp32dev -t upload
; Monitor: pio device monitor
;
; ==========================================================

[platformio]
default_envs = esp32dev
src_dir = src
include_dir = include

; ----------------------------------------------------------
; Shared settings
; ----------------------------------------------------------
[common]
framework = arduino
lib_deps =
    bblanchon/ArduinoJson@^7.0.0
monitor_speed = 115200
monitor_filters = esp32_exception_decoder
board_build.partitions = huge_app.csv
build_flags =
    -DCORE_DEBUG_LEVEL=1
    -DARDUINOJSON_ENABLE_PROGMEM=1

; ----------------------------------------------------------
; ESP32 — Generic DevKit (most common, BLE 4.x)
; ----------------------------------------------------------
[env:esp32dev]
platform = espressif32
board = esp32dev
framework = ${common.framework}
lib_deps = ${common.lib_deps}
monitor_speed = ${common.monitor_speed}
monitor_filters = ${common.monitor_filters}
board_build.partitions = ${common.board_build.partitions}
build_flags = ${common.build_flags}

; ----------------------------------------------------------
; ESP32-S3 (BLE 5.x, recommended for future drone RID)
; ----------------------------------------------------------
[env:esp32-s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = ${common.framework}
lib_deps = ${common.lib_deps}
monitor_speed = ${common.monitor_speed}
monitor_filters = ${common.monitor_filters}
board_build.partitions = ${common.board_build.partitions}
build_flags =
    ${common.build_flags}
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1

; ----------------------------------------------------------
; ESP32-C3
; ----------------------------------------------------------
[env:esp32-c3]
platform = espressif32
board = esp32-c3-devkitm-1
framework = ${common.framework}
lib_deps = ${common.lib_deps}
monitor_speed = ${common.monitor_speed}
monitor_filters = ${common.monitor_filters}
board_build.partitions = ${common.board_build.partitions}
build_flags =
    ${common.build_flags}
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1

; ----------------------------------------------------------
; Seeed XIAO ESP32-S3 (OUI-SPY Patch hardware)
; ----------------------------------------------------------
[env:xiao-s3]
platform = espressif32
board = seeed_xiao_esp32s3
framework = ${common.framework}
lib_deps = ${common.lib_deps}
monitor_speed = ${common.monitor_speed}
monitor_filters = ${common.monitor_filters}
board_build.partitions = ${common.board_build.partitions}
build_flags =
    ${common.build_flags}
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
